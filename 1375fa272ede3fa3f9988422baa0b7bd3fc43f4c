cherry-picked to release branch
